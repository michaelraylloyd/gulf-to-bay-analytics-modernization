flowchart TD

    %% ======================================================
    %%   FABRIC SALES ANALYTICS â€” DQ RULE AUTHORING LIFECYCLE
    %% ======================================================

    %% -------- AUTHORING --------
    subgraph Authoring["Rule Authoring"]
        A1["Draft Rule<br/>Steward proposes new rule"]
        A2["Define Logic<br/>Null / Type / Domain / FK / Custom"]
        A3["Add Metadata<br/>Severity, description, owner"]
        A4["Local Validation<br/>Test on sample data"]
    end

    %% -------- REVIEW --------
    subgraph Review["Review & Approval"]
        R1["Peer Review<br/>Steward team"]
        R2["Business Review<br/>Owner validates intent"]
        R3["Engineering Review<br/>Feasibility & performance"]
        R4["Approval<br/>Rule accepted or rejected"]
    end

    %% -------- DEPLOYMENT --------
    subgraph Deploy["Deployment"]
        D1["Update expectations.json"]
        D2["Commit to Repo<br/>Version-controlled"]
        D3["Promote to Dev Workspace"]
        D4["Pipeline Test Run<br/>Validate behavior"]
        D5["Promote to Prod"]
    end

    %% -------- MONITORING --------
    subgraph Monitor["Monitoring"]
        M1["Track Rule Performance<br/>Pass/Fail ratios"]
        M2["Detect False Positives"]
        M3["Detect Rule Drift<br/>Schema or business changes"]
    end

    %% -------- FEEDBACK LOOP --------
    subgraph Feedback["Continuous Improvement"]
        F1["Refine Rule Logic"]
        F2["Adjust Severity"]
        F3["Retire Obsolete Rules"]
    end

    %% FLOWS
    A1 --> A2 --> A3 --> A4 --> R1
    R1 --> R2 --> R3 --> R4

    R4 -->|Approved| D1 --> D2 --> D3 --> D4 --> D5
    R4 -->|Rejected| A1

    D5 --> M1 --> M2 --> M3 --> F1
    F1 --> A2
    F2 --> A3
    F3 --> A1